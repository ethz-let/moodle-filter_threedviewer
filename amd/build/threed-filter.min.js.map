{"version":3,"sources":["../src/threed-filter.js"],"names":["init","loader","loaders","ktx2","setTranscoderPath","draco","setDecoderPath","modelLinks","document","querySelectorAll","forEach","el","addr","URL","width","searchParams","get","noWireframe","zoom","noCenter","noScale","height","pathname","endsWith","setAttribute","href","replace","search","viewer","createElement","model","appendChild","cloneNode","parentNode","replaceChild"],"mappings":"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","sourcesContent":["import {loader} from \"filter_threedviewer/threed-viewer\";\n\nexport const init = () => {\n    loader.loaders.ktx2.setTranscoderPath('/filter/threedviewer/libs/basis/');\n    loader.loaders.draco.setDecoderPath('/filter/threedviewer/libs/draco/');\n\n    const modelLinks = document.querySelectorAll(':not(threed-model) > a[href*=\".stl\"], :not(threed-model) > a[href*=\".gltf\"], :not(threed-model) > a[href*=\".glb\"]');\n    modelLinks.forEach((el) => {\n        const addr = new URL(el);\n        const width = addr.searchParams.get('width');\n        const noWireframe = addr.searchParams.get('nowireframe');\n        const zoom = addr.searchParams.get('zoom');\n        const noCenter = addr.searchParams.get('nocenter');\n        const noScale = addr.searchParams.get('noScale');\n        let height = addr.searchParams.get('height');\n\n        if (!addr.pathname.endsWith('.stl') &&\n                !addr.pathname.endsWith('.gltf') &&\n                !addr.pathname.endsWith('.glb')) {\n            return;\n        }\n\n        if (!height || height == '') {\n            height = \"300px\";\n        }\n\n        el.setAttribute('href', addr.href.replace(addr.search, ''));\n\n        const viewer = document.createElement('threed-viewer');\n        viewer.setAttribute('controls', '');\n        viewer.setAttribute('help', '');\n        viewer.setAttribute('toolbar', '');\n        viewer.setAttribute('axis-helper', '');\n        if (!!width && width != '') {\n            viewer.setAttribute('width', width);\n        }\n        if (!!height && height != '') {\n            viewer.setAttribute('height', height);\n        }\n        if (noWireframe === null) {\n            viewer.setAttribute('wireframe', '');\n        }\n        if (zoom !== null && zoom != '') {\n            viewer.setAttribute('camera-zoom', zoom);\n        }\n        const model = document.createElement('threed-model');\n        if (noScale === null) {\n            model.setAttribute('scale', '');\n        }\n        if (noCenter === null) {\n            model.setAttribute('center', '');\n        }\n        model.appendChild(el.cloneNode());\n        viewer.appendChild(model);\n        el.parentNode.replaceChild(viewer, el);\n    });\n};\n"],"file":"threed-filter.min.js"}